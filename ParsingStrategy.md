## 메일 제목 파싱 방법 정리 (수정본)

### 1단계: 기본 패턴 검색
제목에서 다음 패턴들을 먼저 찾습니다:

**패턴1**: `대문자2개 + 숫자5개 + 소문자1개 + 대문자2개 + 소문자1개`
- 예: PL25016aIRa, PS25003pPLa

**패턴2**: `대문자2개 + 숫자5개 + _ + 대문자2개 + 소문자1개`
- 예: PL25015_KRa, PL24005_TLb

**패턴3**: `대문자2개 + 숫자5개 + (소문자+_) + 대문자2개 + 소문자1개`
- 예: PL25016a_IRa → 소문자 'a' 우선, '_' 삭제

**패턴4**: `대문자2개 + 숫자5개 + (_+소문자) + 대문자2개 + 소문자1개`
- 예: PL25016_aIRa → 소문자 'a' 우선, '_' 삭제

### 2단계: JWG 패턴 검색
1단계에서 패턴을 못 찾으면 JWG 패턴을 확인:

- **패턴1**: `JWG + (하이픈+문자들) + 숫자5개 + 문자1개` + (선택적으로 회신문자 _, a, b, c, )
- 예: JWG-CS25001e, JWG-SDT25001a
- **패턴2**: `JWG + (하이픈+문자들) + 숫자5개 + 문자1개` + (선택적으로 회신문자 _, a, b, c, ) + 대문자2개 + 소문자1개`
- 예: JWG-CS25001eKRa, JWG-SDT25001aABb, JWG-SDT25001_ABb
- **패턴3**: `JWG + (하이픈+문자들) + 숫자5개 + 문자1개` + ((_+소문자) or ( 소문자__)) + 대문자2개 + 소문자1개`
- 예: JWG-CS25001a_KRa, JWG-SDT25001_aABb → 소문자 'a' 우선, '_' 삭제

### 3단계: 대소문자 구분 없이 재검색
1, 2단계에서 패턴을 못 찾으면 **대소문자 구분 없이** 다시 패턴 검색:
- pl25016aira, PL25016AIRA 등도 파싱 가능

### 4단계: 특수 케이스 처리
- **Multilateral**: "Multilateral"만 파싱
- **특수 접두사 처리**: 
  - RE:, Re:, re:
  - FW:, Fw:, fw:
  - Automatic reply:
  - Bilateral
  - 이런 접두사가 있어도 내부의 패턴은 계속 찾음

### 5단계: 파싱 규칙
패턴을 찾았다면:
- **패널 타입**: PL, PS, JWG
- **패널 이름**: PL/PS의 경우 앞 2글자 (대소문자 구분 없음)
- **년도**: 2자리 숫자
- **회차**: 3자리 숫자
- **회차버전**: 
  - 소문자만 있으면 → 소문자 사용
  - _만 있으면 → _ 사용
  - **소문자와 _ 둘 다 있으면 → 소문자 우선, _ 삭제**
- **기관코드**: 대문자 2개
- **회신번호**: 마지막 소문자 1개

### 6단계: 최종 예외 처리
위의 모든 시도에서 패턴이 없으면 → **예외 메일로 분류**

### 파싱 예시:
```
"PL25016a_IRa: ..."
→ 패널타입: PL, 년도: 25, 회차: 016, 회차버전: a (_ 삭제), 기관: IR, 회신: a

"pl25016aira: ..." (대소문자 구분 없이 처리)
→ 패널타입: PL, 년도: 25, 회차: 016, 회차버전: a, 기관: IR, 회신: a

"테스트 Graph API 직접 테스트"
→ 예외 메일
```